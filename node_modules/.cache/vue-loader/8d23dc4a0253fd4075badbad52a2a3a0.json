{"remainingRequest":"C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\src\\pages\\admin\\Admin.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\src\\pages\\admin\\Admin.vue","mtime":1604217662000},{"path":"C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602893211453},{"path":"C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1597332929808},{"path":"C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602893211453},{"path":"C:\\Users\\Alexey\\Desktop\\ЛЦТ\\kk\\hacaton-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1602893217884}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBodHRwIGZyb20gJ0AvaHR0cC9odHRwJzsKaW1wb3J0IHJvdXRlIGZyb20gJ0AvbWl4aW5zL3JvdXRlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQWRtaW4nLAogIGFzeW5jIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy5pc1JvdXRlQXZhaWxhYmxlKCdBRE1JTicpKSB7CiAgICAgIHRoaXMudXNlcnMgPSBhd2FpdCBodHRwLmdldEFsbFVzZXIoKTsKICAgICAgdGhpcy50YXNrcyA9IGF3YWl0IGh0dHAuZ2V0QWxsVGFza3MoKTsKICAgIH0KICB9LAogIG1peGluczogWyByb3V0ZSBdLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyVGFibGVIZWFkZXJzOiBbCiAgICAgICAgeyB0ZXh0OiAn0KTQmNCeJywgdmFsdWU6ICduYW1lJyB9LAogICAgICAgIHsgdGV4dDogJ9Cg0L7Qu9GMJywgdmFsdWU6ICdyb2xlTmFtZScgfSwKICAgICAgXSwKICAgICAgdXNlcnM6IFtdLAogICAgICB0YXNrVGFibGVIZWFkZXJzOiBbCiAgICAgICAgeyB0ZXh0OiAn0JfQsNC00LDQvdC40LUnLCB2YWx1ZTogJ25hbWUnIH0sCiAgICAgICAgeyB0ZXh0OiAn0JvQtdCz0LXQvdC00LAnLCB2YWx1ZTogJ2xlZ2VuZCcgfSwKICAgICAgICB7IHRleHQ6ICfQntC/0LjRgdCw0L3QuNC1JywgdmFsdWU6ICdkZXNjcmlwdGlvbicgfSwKICAgICAgXSwKICAgICAgdGFza3M6IFtdLAogICAgICBpc1Nob3duTWVudTogZmFsc2UsCiAgICAgIGlzU2hvd25Vc2VyVGFibGU6IHRydWUsCiAgICAgIGlzU2hvd25UYXNrVGFibGU6IGZhbHNlLAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZGVsZXRlSXRlbXMoKSB7CiAgICAgIGlmICh0aGlzLmlzU2hvd25Vc2VyVGFibGUpIHsKICAgICAgICBhd2FpdCB0aGlzLmRlbGV0ZVVzZXJzKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNTaG93blRhc2tUYWJsZSkgewogICAgICAgIGF3YWl0IHRoaXMuZGVsZXRlVGFza3MoKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGRlbGV0ZVVzZXJzKCkgewogICAgICBjb25zdCB1c2Vyc0FycmF5ID0gdGhpcy4kcmVmcy51c2VydGFibGUuc2VsZWN0aW9uOwogICAgICBpZiAodXNlcnNBcnJheSkgewogICAgICAgIGZvciAoY29uc3QgdXNlcnNBcnJheUtleSBpbiB1c2Vyc0FycmF5KSB7CiAgICAgICAgICBpZiAodXNlcnNBcnJheVt1c2Vyc0FycmF5S2V5XS5yb2xlICE9PSAnQURNSU4nKSB7CiAgICAgICAgICAgIGF3YWl0IGh0dHAuZGVsZXRlVXNlckJ5SWQodXNlcnNBcnJheVt1c2Vyc0FycmF5S2V5XS5pZCk7CiAgICAgICAgICAgIHRoaXMudXNlcnMgPSB0aGlzLnVzZXJzLmZpbHRlcih2ID0+IHYuaWQgIT09IHVzZXJzQXJyYXlbdXNlcnNBcnJheUtleV0uaWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFzeW5jIGRlbGV0ZVRhc2tzKCkgewogICAgICBjb25zdCB0YXNrQXJyYXkgPSB0aGlzLiRyZWZzLnRhc2t0YWJsZS5zZWxlY3Rpb247CiAgICAgIGlmICh0YXNrQXJyYXkpIHsKICAgICAgICBmb3IgKGNvbnN0IHRhc2tLZXkgaW4gdGFza0FycmF5KSB7CiAgICAgICAgICBhd2FpdCBodHRwLmRlbGV0ZVRhc2tCeUlkKHRhc2tBcnJheVt0YXNrS2V5XS5pZCk7CiAgICAgICAgICB0aGlzLnRhc2tzID0gdGhpcy50YXNrcy5maWx0ZXIodiA9PiB2LmlkICE9PSB0YXNrQXJyYXlbdGFza0tleV0uaWQpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNob3dUYWJsZSh0YWJsZU5hbWUpIHsKICAgICAgaWYgKHRhYmxlTmFtZSA9PT0gJ3VzZXInKSB7CiAgICAgICAgdGhpcy5pc1Nob3duVXNlclRhYmxlID0gdHJ1ZTsKICAgICAgICB0aGlzLmlzU2hvd25UYXNrVGFibGUgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAodGFibGVOYW1lID09PSAndGFzaycpIHsKICAgICAgICB0aGlzLmlzU2hvd25UYXNrVGFibGUgPSB0cnVlOwogICAgICAgIHRoaXMuaXNTaG93blVzZXJUYWJsZSA9IGZhbHNlCiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["Admin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Admin.vue","sourceRoot":"src/pages/admin","sourcesContent":["<template>\n <div class=\"admin-container\" v-if=\"isRouteAvailable('ADMIN')\">\n   <div class=\"off-canvas-menu\" :class=\"{ 'shown': isShownMenu }\">\n     <custom-icon\n         class=\"icon-menu\"\n         name=\"form\"\n         color=\"black\"\n         container-size=\"large\"\n         @click=\"isShownMenu=!isShownMenu\"\n     />\n     <div v-if=\"isShownMenu\">\n       <div class=\"menu-row\" @click=\"showTable('task')\">\n          <custom-icon name=\"admin-task\" color=\"#66788A\" container-size=\"medium\"/>\n          Домашние задания\n       </div>\n       <div class=\"menu-row\" @click=\"showTable('user')\">\n          <custom-icon name=\"admin-user\" color=\"#66788A\" container-size=\"medium\"/>\n          Пользователи\n       </div>\n     </div>\n   </div>\n   <div class=\"table-container\">\n     <v-data-table\n         v-if=\"isShownUserTable\"\n         ref=\"usertable\"\n         class=\"user-table\"\n         :headers=\"userTableHeaders\"\n         :items=\"users\"\n         show-select\n         hide-default-footer\n     >\n        <template slot=\"no-data\">\n          <span>Данных не найдено</span>\n        </template>\n     </v-data-table>\n     <v-data-table\n         v-if=\"isShownTaskTable\"\n         ref=\"tasktable\"\n         class=\"user-table\"\n         :headers=\"taskTableHeaders\"\n         :items=\"tasks\"\n         show-select\n         hide-default-footer\n     >\n       <template slot=\"no-data\">\n         <span>Данных не найдено</span>\n       </template>\n     </v-data-table>\n     <div class=\"delete-icon\" @click=\"deleteItems\">\n       <custom-icon name=\"trash\"></custom-icon>\n       Удалить\n     </div>\n   </div>\n </div>\n</template>\n\n<script>\nimport http from '@/http/http';\nimport route from '@/mixins/route';\n\nexport default {\n  name: 'Admin',\n  async created() {\n    if (this.isRouteAvailable('ADMIN')) {\n      this.users = await http.getAllUser();\n      this.tasks = await http.getAllTasks();\n    }\n  },\n  mixins: [ route ],\n  data() {\n    return {\n      userTableHeaders: [\n        { text: 'ФИО', value: 'name' },\n        { text: 'Роль', value: 'roleName' },\n      ],\n      users: [],\n      taskTableHeaders: [\n        { text: 'Задание', value: 'name' },\n        { text: 'Легенда', value: 'legend' },\n        { text: 'Описание', value: 'description' },\n      ],\n      tasks: [],\n      isShownMenu: false,\n      isShownUserTable: true,\n      isShownTaskTable: false,\n    }\n  },\n  methods: {\n    async deleteItems() {\n      if (this.isShownUserTable) {\n        await this.deleteUsers();\n      }\n      if (this.isShownTaskTable) {\n        await this.deleteTasks();\n      }\n    },\n    async deleteUsers() {\n      const usersArray = this.$refs.usertable.selection;\n      if (usersArray) {\n        for (const usersArrayKey in usersArray) {\n          if (usersArray[usersArrayKey].role !== 'ADMIN') {\n            await http.deleteUserById(usersArray[usersArrayKey].id);\n            this.users = this.users.filter(v => v.id !== usersArray[usersArrayKey].id);\n          }\n        }\n      }\n    },\n    async deleteTasks() {\n      const taskArray = this.$refs.tasktable.selection;\n      if (taskArray) {\n        for (const taskKey in taskArray) {\n          await http.deleteTaskById(taskArray[taskKey].id);\n          this.tasks = this.tasks.filter(v => v.id !== taskArray[taskKey].id);\n        }\n      }\n    },\n    showTable(tableName) {\n      if (tableName === 'user') {\n        this.isShownUserTable = true;\n        this.isShownTaskTable = false;\n      }\n      if (tableName === 'task') {\n        this.isShownTaskTable = true;\n        this.isShownUserTable = false\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"sass\" scoped>\n  .admin-container\n    display: flex\n    padding: 60px\n\n  .off-canvas-menu\n    height: 100vh\n    width: fit-content\n    padding-right: 40px\n    margin: 0\n\n    &.shown\n      width: 300px\n\n  .user-table\n    width: 70vw\n\n  .icon-menu\n    margin-bottom: 20px\n    cursor: pointer\n\n  .menu-row\n    display: flex\n    align-items: center\n    line-height: 40px\n    column-gap: 20px\n    color: #66788A\n    font-weight: 600\n    font-size: 16px\n    margin-bottom: 10px\n    cursor: pointer\n    padding-left: 5px\n\n    &:hover\n      background: #cccc\n      border-radius: 10px\n\n  .table-container\n    position: relative\n\n  .delete-icon\n    position: absolute\n    left: 0\n    top: -50px\n    padding: 10px 20px\n    border-radius: 8px\n    background: #5843BE\n    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.14), 0 2px 1px rgba(0, 0, 0, 0.12), 0 1px 3px rgba(0, 0, 0, 0.2)\n    display: flex\n    align-items: center\n    justify-content: center\n    column-gap: 10px\n    cursor: pointer\n    font-weight: 500\n    font-size: 14px\n    line-height: 16px\n</style>"]}]}